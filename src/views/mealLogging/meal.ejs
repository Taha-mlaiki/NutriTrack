<%- include("../partials/header") %>

<link 
  rel="stylesheet" 
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<body class="bg-lime-50 text-gray-800 font-sans"></body>
  <!-- Header -->
 <%- include('../partials/navbar') %>

  <!-- Main Content -->
  <main class="max-w-5xl mx-auto px-4 my-8">
    <!-- Page Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-800">Log Your Meal</h1>
      <p class="text-gray-500">Track your nutrition with AI-powered analysis</p>
    </div>

    <!-- Logging Options -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
      <div id="imageOption" class="bg-white rounded-xl p-6 shadow hover:shadow-lg text-center border-2 border-green-600 cursor-pointer transition">
        <div class="w-20 h-20 rounded-full bg-green-600 flex items-center justify-center mx-auto mb-4 text-white text-3xl">
          <i class="fas fa-camera"></i>
        </div>
        <h3 class="text-lg font-semibold mb-1">Image Analysis</h3>
        <p class="text-gray-500">Take a photo of your meal for automatic nutrient detection</p>
      </div>

      <div id="manualOption" class="bg-white rounded-xl p-6 shadow hover:shadow-lg text-center border-2 border-transparent cursor-pointer transition">
        <div class="w-20 h-20 rounded-full bg-orange-500 flex items-center justify-center mx-auto mb-4 text-white text-3xl">
          <i class="fas fa-utensils"></i>
        </div>
        <h3 class="text-lg font-semibold mb-1">Manual Entry</h3>
        <p class="text-gray-500">Search and select foods from our database</p>
      </div>
    </div>

    <!-- Image Upload Section -->
    <section id="uploadSection" class="bg-white rounded-xl p-6 shadow mb-8 block">
      <h2 class="flex items-center gap-2 text-xl font-semibold mb-6 text-gray-800">
        <i class="fas fa-camera text-green-600"></i> Upload Meal Image
      </h2>

      <div id="uploadArea" class="border-2 border-dashed border-gray-300 rounded-xl p-10 text-center hover:border-green-600 cursor-pointer transition mb-6">
        <i class="fas fa-cloud-upload-alt text-5xl text-gray-400 mb-4"></i>
        <h3 class="text-lg font-semibold mb-1">Upload a Photo of Your Meal</h3>
        <p class="text-gray-500 mb-1">Drag & drop an image or click to browse</p>
        <p class="text-gray-400 text-sm mb-4">Supported formats: JPG, PNG (Max 5MB)</p>
        <button id="browseBtn" class="px-4 py-2 rounded-md border-2 border-green-600 text-green-600 font-semibold hover:bg-green-50 transition">
          <i class="fas fa-folder-open"></i> Browse Files
        </button>
        <input type="file" id="fileInput" accept="image/*" class="hidden">
      </div>

      <!-- Camera preview -->
      <div id="cameraPreview" class="hidden max-w-md mx-auto">
        <video id="video" autoplay playsinline class="rounded-lg w-full"></video>
        <canvas id="canvas" class="hidden rounded-lg w-full"></canvas>
        <div class="flex gap-4 justify-center mt-4">
          <button id="captureBtn" class="px-4 py-2 rounded-md border-2 border-green-600 text-green-600 font-semibold hover:bg-green-50 transition">
            <i class="fas fa-camera"></i> Capture
          </button>
          <button id="retakeBtn" class="hidden px-4 py-2 rounded-md border-2 border-green-600 text-green-600 font-semibold hover:bg-green-50 transition">
            <i class="fas fa-redo"></i> Retake
          </button>
        </div>
      </div>

      <div class="flex gap-4 justify-end mt-6">
        <button id="useCameraBtn" class="px-4 py-2 rounded-md border-2 border-green-600 text-green-600 font-semibold hover:bg-green-50 transition">
          <i class="fas fa-camera"></i> Use Camera
        </button>
        <button id="analyzeBtn" disabled class="px-4 py-2 rounded-md bg-orange-500 text-white font-semibold hover:bg-orange-600 transition disabled:opacity-50">
          <i class="fas fa-search"></i> Analyze Meal
        </button>
      </div>
    </section>

    <!-- Manual Section -->
    <section id="manualSection" class="hidden bg-white rounded-xl p-6 shadow mb-8">
      <h2 class="flex items-center gap-2 text-xl font-semibold mb-6 text-gray-800">
        <i class="fas fa-utensils text-orange-500"></i> Manual Food Entry
      </h2>

      <div class="relative mb-6">
        <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
        <input id="foodSearch" type="text" placeholder="Search for foods (e.g., apple, chicken breast)" class="w-full pl-12 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:outline-none">
      </div>

      <div id="foodResults" class="hidden max-h-56 overflow-y-auto border border-gray-300 rounded-md mb-6"></div>
      <div id="selectedFoods" class="mb-6"></div>

      <div class="flex justify-end">
        <button id="analyzeManualBtn" class="px-4 py-2 rounded-md bg-orange-500 text-white font-semibold hover:bg-orange-600 transition">
          <i class="fas fa-calculator"></i> Calculate Nutrition
        </button>
      </div>
    </section>

    <!-- Analysis Section -->
    <section id="analysisSection" class="hidden bg-white rounded-xl p-6 shadow mb-8">
      <h2 class="flex items-center gap-2 text-xl font-semibold mb-6 text-gray-800">
        <i class="fas fa-chart-bar text-green-600"></i> Meal Analysis
      </h2>

      <h3 class="font-semibold mb-3">Detected Foods</h3>
      <div id="detectedFoods" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-6"></div>

      <h3 class="font-semibold mb-3">Nutrition Facts</h3>
      <div class="grid sm:grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-lime-50 border-l-4 border-orange-500 rounded-md p-4 text-center">
          <i class="fas fa-fire"></i>
          <div class="text-xl font-bold">650 cal</div>
          <div class="text-sm text-gray-500">of 2,000 daily</div>
        </div>
        <div class="bg-lime-50 border-l-4 border-green-600 rounded-md p-4 text-center">
          <i class="fas fa-bread-slice"></i>
          <div class="text-xl font-bold">85 g</div>
          <div class="text-sm text-gray-500">of 230 g daily</div>
        </div>
        <div class="bg-lime-50 border-l-4 border-yellow-500 rounded-md p-4 text-center">
          <i class="fas fa-dumbbell"></i>
          <div class="text-xl font-bold">35 g</div>
          <div class="text-sm text-gray-500">of 140 g daily</div>
        </div>
        <div class="bg-lime-50 border-l-4 border-purple-600 rounded-md p-4 text-center">
          <i class="fas fa-oil-can"></i>
          <div class="text-xl font-bold">22 g</div>
          <div class="text-sm text-gray-500">of 70 g daily</div>
        </div>
      </div>

      <div id="mealFeedback" class="bg-yellow-100 border-l-4 border-yellow-500 p-4 rounded-md mb-6">
        <h4 class="font-semibold flex items-center gap-2"><i class="fas fa-exclamation-triangle"></i> Meal Feedback</h4>
        <p>This meal is low in protein for your muscle gain goal. Consider adding a protein source like chicken, fish, or tofu.</p>
      </div>

      <div class="flex gap-4 justify-end">
        <button id="editMealBtn" class="px-4 py-2 rounded-md border-2 border-green-600 text-green-600 font-semibold hover:bg-green-50 transition">
          <i class="fas fa-edit"></i> Edit Meal
        </button>
        <button id="saveMealBtn" class="px-4 py-2 rounded-md bg-orange-500 text-white font-semibold hover:bg-orange-600 transition">
          <i class="fas fa-save"></i> Save to Log
        </button>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white text-center py-6 mt-12">
    <h3 class="text-xl font-bold">NutriTrack</h3>
    <p class="text-gray-400">Your intelligent nutrition companion</p>
    <div class="mt-4 text-gray-500 text-sm">&copy; 2024 NutriTrack. All rights reserved.</div>
  </footer>

  





<%- include("../partials/footer") %>